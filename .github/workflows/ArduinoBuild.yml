# ArduinoBuild.yml
#
# Github workflow script that compiles all examples from the OpenMRNLite
# Arduino library.
#
# Copyright (C) 2021  Balazs Racz
#

# Name of workflow
name: LibraryBuild
on: push
jobs:
  build:
    name: Build ESP32 examples
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@master

    - name: Generate OpenMRNLite library
      run: |
        mkdir --parents $HOME/Arduino/libraries/OpenMRNLite
        $GITHUB_WORKSPACE/arduino/libify.sh $HOME/Arduino/libraries/OpenMRNLite $GITHUB_WORKSPACE -f -l

    - name: Compile all STM32 examples
      uses: ArminJo/arduino-test-compile@v3.0.0
      with:
        platform-url: https://raw.githubusercontent.com/stm32duino/BoardManagerFiles/master/STM32/package_stm_index.json
        arduino-board-fqbn: STM32:stm32:Nucleo_144:pnum=NUCLEO_F767ZI,xserial=generic,usb=CDCgen,xusb=FS,opt=osstd,rtlib=nano
        sketch-names: STM*.ino
        debug-compile: true
        debug-install: true
        
    - name: Compile all ESP32 examples
      uses: ArminJo/arduino-test-compile@v3.0.0
      with:
        platform-url: https://dl.espressif.com/dl/package_esp32_index.json
        arduino-board-fqbn: esp32:esp32:node32s
        sketch-names: ESP*.ino
        debug-compile: true
        debug-install: true

        
